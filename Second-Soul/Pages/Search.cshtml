@page
@model Second_Soul.Pages.SearchModel
@{
	ViewData["Title"] = "Search Results";
	Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - Second_Soul</title>
	<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
	<link rel="stylesheet" href="~/Second_Soul.styles.css" asp-append-version="true" />
</head>
<body>
	<header class="header-background">
		<nav class="navbar navbar-expand-sm navbar-light">
			<div class="container">
				<a class="navbar-brand" asp-area="" asp-page="/Index">
					<img src="/pic/logo/2ndsoullogonoBG.png" alt="Second Soul Logo" style="height: 60px;" />
				</a>
				<div class="collapse navbar-collapse">
					<ul class="navbar-nav me-auto">
						<li class="nav-item">
							<a class="nav-link" href="#" style="color: saddlebrown;">Shop</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#" style="color: saddlebrown;">Category</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#" style="color: saddlebrown;">Product</a>
						</li>
					</ul>
					<form method="get" asp-page="/Search" class="d-flex" style="flex-grow: 1; margin-left: 20px;">
						<input class="form-control me-2" type="search" name="query" placeholder="Tìm kiếm..." aria-label="Search" />
						<button class="btn btn-outline-light" type="submit">Search</button>
					</form>
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link" href="#" style="color: saddlebrown;">Thông Báo</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#" style="color: saddlebrown;">Cart</a>
						</li>
						<li class="nav-item">
							<a asp-page="/Login" class="nav-link" style="color: saddlebrown;">Login</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
<h2>Search Results for "@Model.Query"</h2>

<form method="get">
	<div class="form-group">
		<label for="query">Search</label>
		<input type="text" name="query" class="form-control" value="@Model.Query" placeholder="Search products..." />
	</div>

	<div class="form-group">
		<label for="minPrice">Min Price</label>
		<input type="number" name="minPrice" class="form-control" value="@Model.MinPrice" pattern="^(0*([1-9][0-9]*|0)(\.[0-9]*)?)$" placeholder="Min Price" />
	</div>

	<div class="form-group">
		<label for="maxPrice">Max Price</label>
		<input type="number" name="maxPrice" class="form-control" value="@Model.MaxPrice" pattern="^(0*([1-9][0-9]*|0)(\.[0-9]*)?)$" placeholder="Max Price" />
	</div>
	@if (Model.Categories.Count > 0)
	{
		<div class="form-group">
			<label>Category</label>
			@foreach (var parentCategoryGroup in Model.Categories.GroupBy(c => c.Group.Name))
			{
				// Display parent category name
				<div class="form-check">
					<strong>@parentCategoryGroup.Key</strong>
				</div>
				foreach (var subCategory in parentCategoryGroup)
				{
					<div class="form-check pl-4">
						<input type="checkbox" name="categoryIDs" value="@subCategory.Value" class="form-check-input"
						@(subCategory.Selected ? "checked" : "") />
						<label class="form-check-label">@subCategory.Text</label>
					</div>
				}
			}
		</div>
	}

	@if (Model.Conditions.Count > 0)
	{
		<div class="form-group">
			<label for="condition">Condition</label>
			@Html.DropDownList("condition", Model.Conditions, "Select Condition", new { @class = "form-control" })
		</div>
	}

	<div class="form-group">
		<label for="sellerID">Seller ID</label>
		<input type="number" name="sellerID" class="form-control" value="@Model.SellerID" placeholder="Seller ID" />
	</div>

	<div class="form-group">
		<label for="isAvailable">Available</label>
		<input type="checkbox" name="isAvailable" @(Model.IsAvailable == true ? "checked" : "") />
	</div>

	<button type="submit" class="btn btn-primary">Search</button>
</form>

<h3>Results</h3>
<ul>
	@if (Model.Products.Any())
	{
		foreach (var product in Model.Products)
		{
			<li>@product.Name - @product.Price</li>
		}
	}
	else
	{
		<li>No products found.</li>
	}
</ul>

<!-- Pagination Controls -->
<nav aria-label="Page navigation">
	<ul class="pagination">
		@if (Model.HasPreviousPage)
		{
			<li class="page-item">
				<a class="page-link" asp-route-query="@Model.Query" asp-route-pageIndex="@(Model.PageIndex - 1)">Previous</a>
			</li>
		}

		@for (var i = 1; i <= Model.TotalPages; i++)
		{
			<li class="page-item @(i == Model.PageIndex ? "active" : "")">
				<a class="page-link" asp-route-query="@Model.Query" asp-route-pageIndex="@i">@i</a>
			</li>
		}

		@if (Model.HasNextPage)
		{
			<li class="page-item">
				<a class="page-link" asp-route-query="@Model.Query" asp-route-pageIndex="@(Model.PageIndex + 1)">Next</a>
			</li>
		}
	</ul>
</nav>
	<footer class="border-top footer text-muted">
		<div class="container">
			&copy; 2024 - Second_Soul - <a asp-area="" asp-page="/Privacy">Privacy</a>
		</div>
	</footer>

	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="~/js/site.js" asp-append-version="true"></script>

</body>
</html>
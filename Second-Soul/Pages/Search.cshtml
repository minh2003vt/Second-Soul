@page
@model Second_Soul.Pages.SearchModel
@{
	ViewData["Title"] = "Search Results";
}
<script>
	document.querySelectorAll('.toggle-subcategories').forEach(button => {
		button.addEventListener('click', function () {
			const subcategoryList = this.nextElementSibling;
			if (subcategoryList.style.display === 'none' || subcategoryList.style.display === '') {
				subcategoryList.style.display = 'block';
			} else {
				subcategoryList.style.display = 'none';
			}
		});
	});

</script>
<style>
	.card-heading a {
		display: flex;
		justify-content: space-between;
		align-items: center;
		text-decoration: none;
		color: #333;
	}

	.shop__sidebar__subcategory a i {
		margin-left: 30px;
		transition: transform 0.3s ease;
	}

</style>
<section class="breadcrumb-option">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div class="breadcrumb__text">
					<h4>Shop</h4>
					<div class="breadcrumb__links">
						<a href="/index">Home</a>
						<span>Shop</span>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
<section class="shop spad">
	<div class="container">
		<div class="row">
			<form action="get">
				<div class="col-lg-3">
					<div class="shop__sidebar">
						<div class="shop__sidebar__search">
							<input type="text" name="query" class="form-control" value="@Model.Query" placeholder="Search products..." />
							<button type="submit"><span class="icon_search"></span></button>
						</div>
						<div class="shop__sidebar__accordion">
							<div class="accordion" id="accordionExample">

								<div class="card">
									<div class="card-heading">
										<a data-toggle="collapse" data-target="#collapseSubcategory" aria-expanded="false" aria-controls="collapseSubcategory">
											Category
										</a>
									</div>
									<div id="collapseSubcategory" class="collapse" data-parent="#accordionExample">
										<div class="card-body">
											<div class="shop__sidebar__subcategory">
												<ul>
													@if (Model.Categories.Count > 0)
													{
														@foreach (var parentCategoryGroup in Model.Categories.GroupBy(c => c.Group.Name))
														{
															<li>
																<a class="toggle-subcategories" data-toggle="collapse" data-target="#subCollapse@(parentCategoryGroup.Key)" aria-expanded="false" aria-controls="subCollapse@(parentCategoryGroup.Key)">
																	@parentCategoryGroup.Key <i class="fas fa-chevron-down"></i>
																</a>
																<ul id="subCollapse@(parentCategoryGroup.Key)" class="collapse sub-list">
																	@foreach (var subCategory in parentCategoryGroup)
																	{
																		<li>
																			<input type="checkbox" name="categoryIDs" value="@subCategory.Value" class="form-check-input" @(subCategory.Selected ? "checked" : "") />
																			<label class="form-check-label">@subCategory.Text</label>
																		</li>
																	}
																</ul>
															</li>
														}
													}
												</ul>
											</div>
										</div>
									</div>
								</div>
								@if (Model.Conditions.Count > 0)
								{
									<div class="card">
										<div class="card-heading">
											<a data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
												Condition
											</a>
										</div>
										<div id="collapseTwo" class="collapse show" data-parent="#accordionExample">
											<div class="card-body">
												<div class="shop__sidebar__brand">
													<ul>
														@foreach (var condition in Model.Conditions)
														{
															<li><a href="#">@condition.Text</a></li> <!-- Assuming each condition has a 'Text' property -->
														}
													</ul>
												</div>
											</div>
										</div>
									</div>
								}
								@*                             @if (Model.Conditions.Count > 0)
								{
								<div class="form-group">
								<label for="condition">Condition</label>
								@Html.DropDownList("condition", Model.Conditions, "Select Condition", new { @class = "form-control" })
								</div>
								} *@

								<div class="card">
									<div class="card-heading">
										<a data-toggle="collapse" data-target="#collapseThree">Filter Price</a>
									</div>
									<div id="collapseThree" class="collapse show" data-parent="#accordionExample">
										<div class="card-body">
											<div class="shop__sidebar__price">
												<div>
													<input type="number" name="minPrice" class="form-control" value="@Model.MinPrice" min="0" max="999999999" step="1" placeholder="Min Price" />
													<span class="col-form-label col-sm-1 text-center"></span>
													<input type="number" name="maxPrice" class="form-control" value="@Model.MaxPrice" min="0" max="999999999" step="1" placeholder="Max Price" />
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="card">
									<div class="card-heading">
										<a data-toggle="collapse" data-target="#collapseFour">Size</a>
									</div>
									<div id="collapseFour" class="collapse show" data-parent="#accordionExample">
										<div class="card-body">
											<div class="shop__sidebar__size">
												<label for="xs">
													xs
													<input type="radio" id="xs">
												</label>
												<label for="sm">
													s
													<input type="radio" id="sm">
												</label>
												<label for="md">
													m
													<input type="radio" id="md">
												</label>
												<label for="xl">
													xl
													<input type="radio" id="xl">
												</label>
												<label for="2xl">
													2xl
													<input type="radio" id="2xl">
												</label>
												<label for="xxl">
													xxl
													<input type="radio" id="xxl">
												</label>
												<label for="3xl">
													3xl
													<input type="radio" id="3xl">
												</label>
												<label for="4xl">
													4xl
													<input type="radio" id="4xl">
												</label>
											</div>
										</div>
									</div>
								</div>

								<button type="submit" class="btn btn-primary">Search</button>
							</div>
						</div>
					</div>
				</div>
			</form>

			<div class="col-lg-9">
				<div class="shop__product__option">
					<div class="row">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<div class="shop__product__option__left">
								<p>Showing 1–12 of @Model.Products.Count results</p>
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							<div class="shop__product__option__right">
								<p>Sort:</p>
								<select>
									<option value="">Lowest to Highest Price</option>
									<option value="">Higest to Lowest Price</option>
									<option value="">Newest</option>
									<option value="">Oldest</option>
								</select>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					@if (Model.Products.Any())
					{
						@foreach (var product in Model.Products)
						{
							<div class="col-lg-4 col-md-6 col-sm-6">
								<div class="product__item">
									<div class="product__item__pic set-bg" data-setbg="/template/img/product/product-2.jpg">
										<ul class="product__hover">
											<li><a href="#"><img src="/template/img/icon/heart.png" alt=""></a></li>
											<li>
												<a href="#"><img src="/template/img/icon/compare.png" alt=""> <span>Compare</span></a>
											</li>
											<li>
												<a href="/ProductPage/Details/@product.ProductId">
													@if (product.ProductImages != null && product.ProductImages.Count > 0)
													{
														<img src="@product.ProductImages.First()" alt="">
													}
													else
													{
														<div class="placeholder-frame">
															No Image Available
														</div>
													}
												</a>
											</li>
										</ul>
									</div>
									<div class="product__item__text">
										<h6>@product.Name</h6>
										<a href="" class="add-cart">+ Add To Cart</a>
										<h5>@product.Price.ToString("N0") VND</h5>
										<div class="product__color__select">
											<label for="pc-4">
												<input type="radio" id="pc-4">
											</label>
											<label class="active black" for="pc-5">
												<input type="radio" id="pc-5">
											</label>
											<label class="grey" for="pc-6">
												<input type="radio" id="pc-6">
											</label>
										</div>
									</div>
								</div>
							</div>
						}
					}
					else
					{
						<div class="result-item"><p>No products name "@Model.Query"found.</p></div>
					}

				</div>
				<div class="row">
					<div class="col-lg-12">
						<div class="product__pagination">
							@if (Model.HasPreviousPage)
							{
								<a asp-route-query="@Model.Query" asp-route-pageIndex="@(Model.PageIndex - 1)">Previous</a>
							}

							@for (var i = 1; i <= Model.TotalPages; i++)
							{
								<a class="@(i == Model.PageIndex ? "active" : "")" asp-route-query="@Model.Query" asp-route-pageIndex="@i">@i</a>
							}
							@if (Model.HasNextPage)
							{
								<a asp-route-query="@Model.Query" asp-route-pageIndex="@(Model.PageIndex + 1)">Next</a>
							}
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
<!-- Shop Section End -->
@*     <div class="container search-results layout">
        <div class="filters">
            <h2>Search Results for "@Model.Query"</h2>
            <form method="get" class="mb-4">
                <div class="form-group">
                    <label for="query">Search</label>
                    <input type="text" name="query" class="form-control" value="@Model.Query" placeholder="Search products..." />
                </div>

                <div class="form-group">
                    <label for="minPrice">Min Price</label>
                    <input type="number" name="minPrice" class="form-control" value="@Model.MinPrice" min="0" max="999999999" step="1" placeholder="Min Price" />
                </div>

                <div class="form-group">
                    <label for="maxPrice">Max Price</label>
                    <input type="number" name="maxPrice" class="form-control" value="@Model.MaxPrice" min="0" max="999999999" step="1" placeholder="Max Price" />
                </div>

                @if (Model.Categories.Count > 0)
                {
                    <div class="form-group">
                        <label>Category</label>
                        @foreach (var parentCategoryGroup in Model.Categories.GroupBy(c => c.Group.Name))
                        {
                            <div class="form-check">
                                <strong>@parentCategoryGroup.Key</strong>
                            </div>
                            foreach (var subCategory in parentCategoryGroup)
                            {
                                <div class="form-check pl-4">
                                    <input type="checkbox" name="categoryIDs" value="@subCategory.Value" class="form-check-input"
                                    @(subCategory.Selected ? "checked" : "") />
                                    <label class="form-check-label">@subCategory.Text</label>
                                </div>
                            }
                        }
                    </div>
                }

                @if (Model.Conditions.Count > 0)
                {
                    <div class="form-group">
                        <label for="condition">Condition</label>
                        @Html.DropDownList("condition", Model.Conditions, "Select Condition", new { @class = "form-control" })
                    </div>
                }

                @if (Model.Sellers.Count > 0)
                {
                    <div class="form-group">
                        <label for="sellerID">Seller</label>
                        @Html.DropDownList("sellerID", Model.Sellers, new { @class = "form-control" })
                    </div>
                }

                <div class="form-group form-check">
                    <input type="checkbox" name="isAvailable" class="form-check-input" @(Model.IsAvailable ? "checked" : "") />
                    <label class="form-check-label" for="isAvailable">Available</label>
                </div>

                <button type="submit" class="btn btn-primary">Search</button>
            </form>
        </div>

        <div class="results">
            <h3>Results</h3>
            <div>
                @if (Model.Products.Any())
                {
                    @foreach (var product in Model.Products)
                    {
                        <div class="result-item" id="product-@product.ProductId">
                            <h5>
                                <a href="/ProductPage/Details/@product.ProductId">@product.Name</a>
                            </h5>
                            <p>Price: @product.Price</p>
                        </div>
                    }
                }
                else
                {
                    <div class="result-item"><p>No products name "@Model.Query"found.</p></div>
                }
            </div>

            <!-- Pagination Controls -->
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    @if (Model.HasPreviousPage)
                    {
                        <li class="page-item">
                            <a class="page-link" asp-route-query="@Model.Query" asp-route-pageIndex="@(Model.PageIndex - 1)">Previous</a>
                        </li>
                    }

                    @for (var i = 1; i <= Model.TotalPages; i++)
                    {
                        <li class="page-item @(i == Model.PageIndex ? "active" : "")">
                            <a class="page-link" asp-route-query="@Model.Query" asp-route-pageIndex="@i">@i</a>
                        </li>
                    }

                    @if (Model.HasNextPage)
                    {
                        <li class="page-item">
                            <a class="page-link" asp-route-query="@Model.Query" asp-route-pageIndex="@(Model.PageIndex + 1)">Next</a>
                        </li>
                    }
                </ul>
            </nav>
        </div>
    </div>
 *@

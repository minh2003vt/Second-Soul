@page
@model Second_Soul.Pages.ResetPasswordModel
@{
	ViewData["Title"] = "Forgot Password";
}

<h2 class="text-center">Forgot Password</h2>

<div class="container">
	<div class="row justify-content-center">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header text-center">
					<h3>Request Password Reset Token</h3>
				</div>
				<div class="card-body">
					<form method="post" asp-page-handler="RequestToken">
						@if (ViewData["TokenError"] != null)
						{
							<div class="alert alert-danger">
								@ViewData["TokenError"]
							</div>
						}
						<div class="form-group">
							<label for="Email">Email</label>
							<input type="email" id="Email" name="Email" class="form-control" required placeholder="Enter your email" />
						</div>
						<div>
							<button type="submit" class="btn btn-primary btn-block">Send Token</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<div class="row justify-content-center mt-4">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header text-center">
					<h3>Confirm Token</h3>
				</div>
				<div class="card-body">
					<form method="post" asp-page-handler="ConfirmToken">
						<div class="form-group">
							<label asp-for="Input.Email"></label>
							<input asp-for="Input.Email" class="form-control" required placeholder="Enter your email" type="email" />
							<span asp-validation-for="Input.Email" class="text-danger"></span>
						</div>
						<div class="form-group">
							<label asp-for="Input.Token"></label>
							<input asp-for="Input.Token" class="form-control" required placeholder="Enter the token" pattern="^\d{10}$" />
							<span asp-validation-for="Input.Token" class="text-danger"></span>
						</div>
						<div class="form-group">
							<label asp-for="Input.NewPassword"></label>
							<input asp-for="Input.NewPassword" class="form-control" required placeholder="New Password"
								   pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$"
								   title="Password must be at least 8 characters long, with at least one uppercase letter, one lowercase letter, and one number." />
							<span asp-validation-for="Input.NewPassword" class="text-danger"></span>
						</div>
						<div class="form-group">
							<label asp-for="Input.ConfirmPassword"></label>
							<input asp-for="Input.ConfirmPassword" class="form-control" required placeholder="Confirm Password"
								   pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$"
								   title="Password must match the new password." />
							<span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
						</div>
						<div>
							<button type="submit" class="btn btn-primary btn-block">Confirm Token</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

@section Scripts {
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>
}